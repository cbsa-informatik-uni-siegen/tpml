% General

\newcommand{\Kommentar}[1]{}

\newcommand{\name}[1]{{\text{\it #1\/}}}
%\newcommand{\name}[1]{\mathit{#1}}

%\newcommand{\bfbox}[1]{\mathbf{#1}}

\newcommand{\I}{{\cal I}}

% Proof trees

\newcounter{tree}
\newcounter{node}[tree]

\newlength{\treeindent}
\newlength{\nodeindent}
\newlength{\nodesep}

\newcommand{\refnode}[1]
 {\ref{\thetree.#1}}

\newcommand{\contextcolor}{\color{blue}}



\definecolor{darkgreen}{rgb}{0.1,0.5,0}
\definecolor{redexcolor}{rgb}{0.7,1,0}
%\definecolor{argumentcolor}{rgb}{0.7,1,0}
%\definecolor{bindingcolor}{rgb}{0,0,0.8}
%\definecolor{scopecolor}{rgb}{0.8,0,0}
%\definecolor{holecolor}{rgb}{0.1,0.1,0.8}
%\definecolor{parametercolor}{rgb}{0,0,0.8}


\newcommand{\bindingarrow}{{\color{c905} $\longrightarrow$}}
\newcommand{\argument}[1]{\colorbox{c090}{#1}}
\newcommand{\scope}[1]{\colorbox{c992}{#1}}
\newcommand{\hole}[1]{{#1}}
\newcommand{\parameter}[1]{\colorbox{c905}{#1}}

\newcommand{\resulttypecolor}{\color{darkgreen}}

\newcommand{\resultcolor}{\color{blue}}

\newcommand{\byrulecolor}{\color{red}}

\newcommand{\marked}[1]{\colorbox{redexcolor}{$#1$}}

\newcommand{\smallsteparrow}[1]{\stackrel{\mbox{\scriptsize\byrulecolor (#1)}}{\longrightarrow}}

\newcommand{\byrule}[1]{\hspace{-5mm}\byrulecolor\mbox{\scriptsize\ #1}}

\newif\ifarrows 
\arrowsfalse 

\newcommand{\arrow}[3]
  {\ifarrows
   \ncangle[angleA=-90,angleB=#1]{<-}{\thetree.#2}{\thetree.#3}
   \else
   \fi}

\newcommand{\node}[4]
 {\ifarrows
   \else \refstepcounter{node}
         \noindent\hspace{\treeindent}\hspace{#2\nodeindent}
         \rnode{\thetree.#1}{\makebox[6mm]{(\thenode)}}\label{\thetree.#1}
         $\blong 
          #3 \\ 
          \byrule{#4} 
          \elong$
         \vspace{\nodesep}
   \fi}

\newcommand{\dummyarrow}[3]
  {\arrow{#1}{#2}{#3dummy}}

\newcommand{\dummynode}[2]
 {\ifarrows 
  \else \noindent\hspace{\treeindent}\hspace{#2\nodeindent}
         \rnode{\thetree.#1dummy}{\makebox[6mm]{(\refnode{#1})}}\label{\thetree.#1dummy}
         $\ldots$
         \vspace{\nodesep}
   \fi}

\newcommand{\mktree}[1]
 {\stepcounter{tree} #1 \arrowstrue #1 \arrowsfalse}

\fboxrule=0mm

\newcommand{\cenv}[1]{\fbox{$\begin{array}{|ll|}\hline #1 \\\hline\end{array}$}}


% Special Symbols

\newcommand{\uminus}{\widetilde{\ }}
\renewcommand{\uminus}{-\,}
\newcommand{\nop}{()}


% Im X-Symbol-Manual empfohlen

\newcommand{\nsubset}{\not\subset}
%\newcommand{\textflorin}{\textit{f}}
\newcommand{\setB}{{\mathord{\mathbb B}}}
\newcommand{\setC}{{\mathord{\mathbb C}}}
\newcommand{\setN}{{\mathord{\mathbb N}}}
\newcommand{\setQ}{{\mathord{\mathbb Q}}}
\newcommand{\setR}{{\mathord{\mathbb R}}}
\newcommand{\setZ}{{\mathord{\mathbb Z}}}
\newcommand{\coloncolon}{\mathrel{::}}

% Eigene (k\"urzere) Befehle

\newcommand{\pfi}{\varphi}
\newcommand{\eps}{\varepsilon}
\newcommand{\eval}{\Downarrow}
\newcommand{\pto}{\hookrightarrow}
\newcommand{\emp}{\emptyset}
\newcommand{\sleq}{\subseteq}
\newcommand{\sgeq}{\supseteq}
\newcommand{\sqleq}{\sqsubseteq}
\newcommand{\sqgeq}{\sqsupseteq}
\newcommand{\lub}{\bigsqcup}
\newcommand{\glb}{\bigsqcap}
\newcommand{\lsem}{\llbracket}
\newcommand{\rsem}{\rrbracket}
\newcommand{\impl}{\models}
\newcommand{\step}{\vdash}
\newcommand{\tr}{\triangleright}
\newcommand{\cc}{\coloncolon}


% Names (lower case italic)

\newcommand{\exc}{\name{exn}}
\newcommand{\ep}{\name{ep}}

\newcommand{\id}{\name{id}}
\newcommand{\op}{\name{op}}

\newcommand{\true}{\name{true}}
\newcommand{\false}{\name{false}}
\newcommand{\Not}{\name{not}}

\newcommand{\Fst}{\name{fst}}
\newcommand{\Snd}{\name{snd}}

\newcommand{\Hd}{\name{hd}}
\newcommand{\Tl}{\name{tl}}
\newcommand{\Cons}{\name{cons}}
\newcommand{\Empty}{\name{is\_empty}}

\newcommand{\dom}[1]{\name{dom}(#1)}
\newcommand{\free}[1]{\name{free}\,(#1)}
\newcommand{\supp}[1]{\name{supp}\,(#1)}
\newcommand{\curry}[1]{\name{curry}\,(#1)}


% Names (upper case italic)

\newcommand{\Bool}{\name{Bool}}
\newcommand{\Btype}{\name{BType}}

\newcommand{\Conf}{\name{Conf}}
\newcommand{\Const}{\name{Const}}

\newcommand{\Dec}{\name{Dec}}

\newcommand{\EP}{\name{EP}}
\newcommand{\package}[1]{\uparrow #1}
\newcommand{\throw}[1]{\to\ \package{#1}}
\newcommand{\zerodiv}{\name{Division\_by\_zero}}

\newcommand{\Env}{\name{Env}}
\newcommand{\Exn}{\name{Exn}}
\newcommand{\Exp}{\name{Exp}}
\newcommand{\ValR}{\name{Val}_r}

\newcommand{\Id}{\name{Id}}
\newcommand{\Int}{\name{Int}}

\newcommand{\Lexp}{\name{LExp}}
\newcommand{\Loc}{\name{Loc}}

\newcommand{\Op}{\name{Op}}

\newcommand{\Row}{\name{Row}}
\newcommand{\Body}{\name{Body}}
\newcommand{\Type}{\name{Type}}
\newcommand{\TypeR}{\name{Type}_r}
\newcommand{\Ptype}{\name{PType}}
\newcommand{\Tvar}{\name{TVar}}
\newcommand{\Rvar}{\name{RVar}}
\newcommand{\var}[1]{\name{var}(#1)}
\newcommand{\fail}{\mbox{``nicht l\"osbar''}}

\newcommand{\self}{\name{self}}
\newcommand{\hidden}{\diamondsuit}
\newcommand{\hide}[1]{\hidden\,#1}


\newcommand{\Unit}{\name{Unit}}

\newcommand{\Val}{\name{Val}}

% keywords

\newcommand{\exn}{\textbf{exn}}
\newcommand{\inttype}{\textbf{int}}
\newcommand{\real}{\textbf{float}}
\newcommand{\bool}{\textbf{bool}}
\newcommand{\unit}{\textbf{unit}}
\newcommand{\arrowtype}[2]{#1 \to #2}
\newcommand{\blist}{\textbf{list}}
\newcommand{\bref}{\textbf{ref}}
\newcommand{\listtype}[1]{#1\,\blist}
\newcommand{\reftype}[1]{#1\,\bref}
\newcommand{\rectype}[2]{\bmu #1#2}
\newcommand{\objecttype}[1]{<#1>}

\renewcommand{\div}{\mathbin{\textbf{div}}}
\newcommand{\sel}{\mathbin{.}}
%\newcommand{\mod}{\mathbin{\textbf{mod}}}
\renewcommand{\mod}{\textbf{mod}}

\newcommand{\bif}{\textbf{if}}
\newcommand{\bthen}{\textbf{then}}
\newcommand{\belse}{\textbf{else}}

\newcommand{\blet}{\textbf{let}}
\newcommand{\bin}{\textbf{in}}
\newcommand{\bend}{\textbf{end}}

\newcommand{\bval}{\textbf{val}}
\newcommand{\bmethod}{\textbf{method}}
\newcommand{\bfield}{\textbf{field}}
\newcommand{\bthis}{\textbf{this}}
\newcommand{\bself}{\textbf{self}}
\newcommand{\bobject}{\textbf{object}}
\newcommand{\bclass}{\textbf{class}}
\newcommand{\bzeta}{\textbf{$\zeta$}}
\newcommand{\bnew}{\textbf{new}}
\newcommand{\binherit}{\textbf{inherit}}
\newcommand{\bfrom}{\textbf{from}}
\newcommand{\brec}{\textbf{rec}}
\newcommand{\bfun}{\textbf{fun}}
\newcommand{\band}{\textbf{and}}
\newcommand{\btype}{\textbf{type}}
\newcommand{\bmu}{\textbf{$\mu$}}

\newcommand{\andalso}[2]{#1\mathbin{\&\&}#2}
\newcommand{\orelse}[2]{#1\mathbin{\|}#2}
\newcommand{\bandalso}{\textbf{andalso}}
\newcommand{\borelse}{\textbf{orelse}}

\newcommand{\coercion}[3]{(#1\ :\ \subtype{#2}{#3})}
\newcommand{\subtype}[2]{#1\ <:\ #2}

\newcommand{\bwhile}{\textbf{while}}
\newcommand{\bfor}{\textbf{for}}
\newcommand{\bdo}{\textbf{do}}
\newcommand{\bto}{\textbf{to}}

\newcommand{\brepeat}{\textbf{repeat}}
\newcommand{\buntil}{\textbf{until}}

\newcommand{\barray}{\textbf{array}}
\newcommand{\bof}{\textbf{of}}

\newcommand{\app}[2]{#1\,#2}
\newcommand{\bift}[2]{\bif\ #1\ \bthen\ #2}
\newcommand{\bifte}[3]{\bif\ #1\ \bthen\ #2\ \belse\ #3}
\newcommand{\Bifte}[3]{\blong\bif\ #1\\\bthen\ #2\\\belse\ #3\elong}
\newcommand{\bwd}[2]{\bwhile\ #1\ \bdo\ #2}
\newcommand{\bfd}[4]{\bfor\ \vdec{#1}{#2}\ \bto\ #3\ \bdo\ #4}
\newcommand{\bru}[2]{\brepeat\ #1\ \buntil\ #2}

\newcommand{\blie}[2]{\blet\ #1\ \bin\ #2 \ \bend}
\newcommand{\vdec}[2]{#1 = #2}
\newcommand{\fdec}[2]{\bval\ #1 = #2}
\newcommand{\mdec}[2]{\bmethod\ #1 = #2}
\newcommand{\object}[2]{\bobject\ (#1)\ #2\ \bend}
\newcommand{\duplication}[1]{\{\ #1\ \}}
\newcommand{\class}[2]{\bclass\ (#1)\ #2\ \bend}
\newcommand{\classtype}[2]{\bzeta (#1 : #2)}
\newcommand{\new}[1]{\bnew\ #1}
\newcommand{\inherit}[3]{\binherit\ #1\ \bfrom\ #2\ ;\ #3}
\newcommand{\head}{\name{head}}
\newcommand{\body}{\name{body}}
\newcommand{\clone}[1]{\{\langle #1 \rangle\}}
\newcommand{\tdec}[2]{\btype\ #1 = #2}
\newcommand{\rec}[2]{\brec\ #1.#2}
\newcommand{\recdots}[2]{\brec\ #1.\ \ldots}
\newcommand{\abstr}[2]{\lambda #1.#2}
\newcommand{\appl}[2]{#1\,#2}
\newcommand{\attr}[2]{\bval\ #1=#2;}
\newcommand{\method}[2]{\bmethod\ #1=#2\ ;}
\newcommand{\curriedmethodone}[3]{\bmethod\ #1\ #2=#3\ ;}
\newcommand{\curriedmethodtwo}[4]{\bmethod\ #1\ #2\ #3=#4\ ;}
\newcommand{\send}[2]{#1 \# #2}
\newcommand{\Ref}{\name{ref}}
\newcommand{\Deref}{\,!\,}
\newcommand{\Assign}{\ :=\ }

\newcommand{\doma}[1]{\name{dom}_a\,(#1)}

% Typing rules 

\newcommand{\tj}[2]{#1\cc#2}
\newcommand{\ctj}[2]{\tj{#1}{{\resulttypecolor #2}}}
\newcommand{\Tj}[3]{#1 \, \triangleright \, #2\cc#3}
\newcommand{\Tjm}[3]{#1\,\triangleright_m\,#2\coloncolon#3}
\newcommand{\cTj}[3]{\Tj{{\contextcolor #1}}{#2}{{\resulttypecolor #3}}}
\newcommand{\cbig}[2]{#1 \ \eval\ {\resultcolor #2}}
\newcommand{\cBig}[2]{#1 \\ \eval\ {\resultcolor #2}}


\newcommand{\Tjl}[3]{#1 \,\tr_l\, #2\cc#3}
\newcommand{\Tjh}[2]{#1 \, \tr\,  #2}

\newcommand{\Clos}[2]{\name{Closure}_{#1}(#2)}
\newcommand{\sol}[3]{\name{solution}\,(#1,#2,#3)}
\newcommand{\unify}{\name{unify}}


\newcommand{\brule}[1]{\begin{markiere}[#1]}
\newcommand{\erule}{\end{markiere}}

\newcommand{\regel}[2]{\begin{array}{@{}c@{}} #1 \\ \hline #2 \end{array}}

\newcommand{\reason}[1]{\ \mbox{#1}}
\newcommand{\Reason}[1]{\\ \mbox{#1}}


% Program verification

\newcommand{\conj}{\,\land\,}
\newcommand{\Conj}{\bigwedge}
\newcommand{\disj}{\,\lor\,}
\newcommand{\Disj}{\bigvee\,}
\newcommand{\all}[1]{\forall{#1}.\,}
\newcommand{\ex}[1]{\exists{#1}.\,}

\newcommand{\disjoint}[2]{\name{disj}(#1,#2)}
\newcommand{\cont}[2]{#1 \mapsto #2}
\newcommand{\DEF}{\name{DEF}}

\newcommand{\ret}[2]{{\bf returns}\ #1.\, #2}
\newcommand{\tc}[2]{#1\,\{#2\}}
\newcommand{\triple}[3]{\{#1\}\,#2\,\{#3\}}

% Index

\newcommand{\define}[1]{{\em #1\/}\index{#1}}
\newcommand{\Define}[2]{{\em #1\/}\index{#2}}
\newcommand{\Index}[1]{\index{#1}}
\newcommand{\notation}[1]{#1\index{#1}}
\newcommand{\engl}[1]{(engl.: \define{#1})}
\newcommand{\Engl}[2]{(engl.: \Define{#1}{#2})}

% Theorems etc.

\newtheorem{theorem}{Satz}
\newtheorem{corollary}{Korollar}
\newtheorem{definition}{Definition}
\newtheorem{example}{Beispiel}
\newenvironment{rex}{\begin{example}\rm}{\end{example}}
%\newtheorem{examples}{Beispiele}
\newtheorem{lemma}{Lemma}

%\renewcommand{\thedefinition}{}
%\renewcommand{\theexample}{}
%\renewcommand{\theexamples}{}
\renewcommand{\theenumi}{\rm (\alph{enumi})}
\renewcommand{\labelenumi}{\theenumi}

%\newcommand{\enumarabic}{\renewcommand{\theenumi}{\rm (\arabic{enumi})}}

%\newcommand{\bcoro}[1]{\begin{corollary}\label{cor:#1}}
%\newcommand{\ecoro}{\end{corollary}}

\newenvironment{rdef}{\begin{definition}\rm}{\end{definition}}

%\newcommand{\brdef}[1]{\begin{definition}\label{def:#1}\rm}
%\newcommand{\erdef}{\end{definition}}

%\newcommand{\blemm}[1]{\begin{lemma}\label{lem:#1}}
%\newcommand{\bLemm}[2]{\begin{lemma}[#2]\label{lem:#1}\index{#2}}
%\newcommand{\elemm}{\end{lemma}}

%\newcommand{\btheo}[1]{\begin{theorem}\label{th:#1}}
%\newcommand{\bTheo}[2]{\begin{theorem}[#2]\label{th:#1}\index{#2}}
%\newcommand{\etheo}{\end{theorem}}

%\newcommand{\litem}[1]{\item\label{it:#1}}
%\newcommand{\ritem}[1]{\ref{it:#1}}


% Grammars

\newcommand{\bgram}{\[\begin{array}{rrlll}}
\newcommand{\egram}{\end{array}\]}

\newcommand{\is}{& ::= &}
\newcommand{\al}{\\ & \mid &}
\newcommand{\n}{\vspace{2mm}\\}




% Other Environments

\newcommand{\bcase}{\left\{\!\!\!\begin{array}{ll}}
\newcommand{\ecase}{\end{array}\right.}
\newcommand{\benum}{\begin{enumerate}}
\newcommand{\eenum}{\end{enumerate}}
\newcommand{\beqns}{\[\begin{array}{rcll}}
\newcommand{\eeqns}{\end{array}\]}
\newcommand{\bitem}{\begin{itemize}}
\newcommand{\eitem}{\end{itemize}}
\newcommand{\blong}{\!\!\begin{array}[t]{l}}
\newcommand{\elong}{\end{array}}
\newcommand{\btabl}{\begin{tabular}}
\newcommand{\etabl}{\end{tabular}}
\newcommand{\brexa}{\begin{example}\enumarabic\rm}
\newcommand{\erexa}{\end{example}}
\newcommand{\brexs}{\begin{examples}\enumarabic\rm}
\newcommand{\erexs}{\end{examples}}


% German abbreviations

\newcommand{\abk}[1]{#1.\ }
\newcommand{\bzw}{\abk{bzw}}
\newcommand{\bzgl}{\abk{bzgl}}
\newcommand{\das}{\abk{d.h}}
\newcommand{\evtl}{\abk{evtl}}
\newcommand{\usw}{\abk{usw}}
\newcommand{\vgl}{\abk{vgl}}
\newcommand{\zb}{\abk{z.B}}


\newcommand{\infix}[3]{#2\mathbin{#1}#3}

\newcommand{\bli}[3]{\blet\ \vdec{#1}{#2}\ \bin\ #3}

\newcommand{\Bli}[3]{\begin{array}[t]{@{}l}
                     \blet\ \vdec{#1}{#2}\\\bin\ #3
                     \end{array}}

\newcommand{\Vdec}[2]{\begin{array}[t]{@{}l}
                      #1 = \\
                      \ #2
                      \end{array}}

\newcommand{\BLI}[3]{\begin{array}[t]{@{}l}
                     \blet\ \Vdec{#1}{#2}\\\bin\ #3
                     \end{array}}

\newcommand{\Abstr}[2]{\begin{array}[t]{@{}l}
                       \lambda #1.\\\ \ #2
                       \end{array}}

\newcommand{\Lom}{\ensuremath{{\cal L}_o^m}}

%%
%% Abstract Syntax
%%

\newcommand{\expAbstr}[2]{\lambda#1.#2}
\newcommand{\expApp}[2]{#1\,#2}
\newcommand{\expCond}[3]{\bif\,#1\,\bthen\,#2\,\belse\,#3}
\newcommand{\expLet}[3]{\blet\,#1=#2\,\bin\,#3}
\newcommand{\expRec}[2]{\brec\,#1.#2}

\newcommand{\expObject}[2]{\bobject\,(#1)\ #2\ \bend}
\newcommand{\expSend}[2]{#1\##2}
\newcommand{\expDupl}[1]{\{\langle#1\rangle\}}

\newcommand{\expCoerce}[2]{(#1:#2)}

\newcommand{\rtypeEmpty}{\emptyset}
\newcommand{\rtypeMethod}[3]{#1:#2;\,#3}

\newcommand{\rowEpsilon}{\epsilon}
\newcommand{\rowVal}[3]{\bval\ #1=#2\ ;\,#3}
\newcommand{\rowMethod}[3]{\bmethod\ #1=#2\ ;\,#3}

