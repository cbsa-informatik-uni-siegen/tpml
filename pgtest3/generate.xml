<?xml version="1.0"?>
<!--
	$Id: build.xml 415 2006-10-11 17:23:59Z benny $
	
	Copyright (c) 2007 Christian Fehler
-->
<project name="de.unisiegen.tpml.core" default="generate" basedir=".">
	<description>
		Generate the languages.
    </description>
	
	<property name="libdir" value="${basedir}/lib" />

    <target name="generate" depends="version,clean-l0,clean-l1,clean-l2,clean-l2o,clean-l3,clean-l4,l0,l1,l2,l2o,l3,l4" description="Generate parsers and lexers" />

	
	<property name="impldir" value="${basedir}/source-impl" />
	<property name="generateddir" value="${basedir}/source-generated" />
	
	<taskdef name="cup" classname="java_cup.anttask.CUPTask" classpath="${libdir}/java-cup-11a.jar" />
	<taskdef name="jflex" classname="JFlex.anttask.JFlexTask" classpath="${libdir}/JFlex-1.4.1.jar" />

	<!--
			Autogenerating files (Versions.java)
		-->

	<property name="generateddir" value="${basedir}/source-generated" />
	<property file="${basedir}/build.properties" />
	
	<target name="version" description="Generate the Versions interface">
		<mkdir dir="${generateddir}/de/unisiegen/tpml/ui" />
		<echo file="${generateddir}/de/unisiegen/tpml/ui/Versions.java" append="false">package de.unisiegen.tpml.ui;

	/**
	 * Automatically generated interface for the project versions.
	 *
	 * @author Benedikt Meurer
	 * @author Christian Fehler
	 * @version $$Ref$$
	 */
	public interface Versions {
		/** The version of the de.unisiegen.tpml.core subproject. */
		public static final String CORE = "${de.unisiegen.tpml.core.version}";

		/** The version of the de.unisiegen.tpml.graphics subproject. */
		public static final String GRAPHICS = "${de.unisiegen.tpml.graphics.version}";

		/** The version of the de.unisiegen.tpml.ui subproject. */
		public static final String UI = "${de.unisiegen.tpml.ui.version}";
		
		/** The string for a testing project. */
		public static final String TEST = " (PGTest3)";
	};
		</echo>
	</target>
	
	<target name="clean-l0">
		<delete dir="${generateddir}/de/unisiegen/tpml/core/languages/l0" />
	</target>

	<target name="clean-l1">
		<delete dir="${generateddir}/de/unisiegen/tpml/core/languages/l1" />
	</target>

	<target name="clean-l2">
		<delete dir="${generateddir}/de/unisiegen/tpml/core/languages/l2" />
	</target>
			
	<target name="clean-l2o">
		<delete dir="${generateddir}/de/unisiegen/tpml/core/languages/l2o" />
	</target>

	<target name="clean-l3">
		<delete dir="${generateddir}/de/unisiegen/tpml/core/languages/l3" />
	</target>
	
	<target name="clean-l4">
		<delete dir="${generateddir}/de/unisiegen/tpml/core/languages/l4" />
	</target>

	<target name="l0" description="Generates lexer and parser for L0">
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l0/l0.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l0/l0.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l0"
			package="de.unisiegen.tpml.core.languages.l0"
			parser="L0AbstractParser"
			symbols="L0Terminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
	</target>
	
	<target name="l1" description="Generates lexer and parser for L1">
		<!-- Expressions -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l1/l1.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l1/l1.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l1"
			package="de.unisiegen.tpml.core.languages.l1"
			parser="L1AbstractParser"
			symbols="L1Terminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
		
		<!-- Types -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l1/l1type.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l1/l1type.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l1"
			package="de.unisiegen.tpml.core.languages.l1"
			parser="L1AbstractTypeParser"
			symbols="L1TypeTerminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
	</target>
	
	<target name="l2" description="Generates lexer and parser for L2">
		<!-- Expressions -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l2/l2.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l2/l2.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l2"
			package="de.unisiegen.tpml.core.languages.l2"
			parser="L2AbstractParser"
			symbols="L2Terminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
		
		<!-- Types -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l2/l2type.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l2/l2type.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l2"
			package="de.unisiegen.tpml.core.languages.l2"
			parser="L2AbstractTypeParser"
			symbols="L2TypeTerminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
	</target>
	
	<target name="l2o" description="Generates lexer and parser for L2O">
		<!-- Expressions -->
		<jflex 
	    	file="${impldir}/de/unisiegen/tpml/core/languages/l2o/l2o.flex"
	    	destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l2o/l2o.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l2o"
			package="de.unisiegen.tpml.core.languages.l2o"
			parser="L2OAbstractParser"
			symbols="L2OTerminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
		
		<!-- Types -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l2o/l2otype.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l2o/l2otype.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l2o"
			package="de.unisiegen.tpml.core.languages.l2o"
			parser="L2OAbstractTypeParser"
			symbols="L2OTypeTerminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
	</target>
	
	<target name="l3" description="Generates lexer and parser for L3">
		<!-- Expressions -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l3/l3.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l3/l3.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l3"
			package="de.unisiegen.tpml.core.languages.l3"
			parser="L3AbstractParser"
			symbols="L3Terminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />

		<!-- Types -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l3/l3type.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l3/l3type.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l3"
			package="de.unisiegen.tpml.core.languages.l3"
			parser="L3AbstractTypeParser"
			symbols="L3TypeTerminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
	</target>
	
	<target name="l4" description="Generates lexer and parser for L4">
		<!-- Expressions -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l4/l4.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l4/l4.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l4"
			package="de.unisiegen.tpml.core.languages.l4"
			parser="L4AbstractParser"
			symbols="L4Terminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />

		<!-- Types -->
		<jflex 
    		file="${impldir}/de/unisiegen/tpml/core/languages/l4/l4type.flex"
    		destdir="${generateddir}"
			nobak="yes" />
		<cup
			srcfile="${impldir}/de/unisiegen/tpml/core/languages/l4/l4type.cup"
			destdir="${generateddir}/de/unisiegen/tpml/core/languages/l4"
			package="de.unisiegen.tpml.core.languages.l4"
			parser="L4AbstractTypeParser"
			symbols="L4TypeTerminals"
			interface="yes"
			debug="no"
			expect="1000000"
			nonterms="no"
			nopositions="no"
			dump_grammar="no" />
	</target>
</project>